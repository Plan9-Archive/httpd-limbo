httpd is a simple httpd.

features:
- http/1.0, http/1.1 (keep-alive, chunked responses).  no "http/0.9".
- scgi support
- virtual hosts
- determining content-type based on file extension
- error/access logging
- index file serving, html directory listings
- http basic authentication
- redirections

todo:
- headers:
	- return "bad request" when a known non-#rule header that is used for the request occurs twice in request
- handle transfer-encoding from client: send error if not identity
- ignore some http/1.1 headers for http/1.0 requests?  e.g. range, many more
- scgid timeouts
- better configurability/syntax for doing redirect/scgi/auth/others based on hostname/port?
- normal cgi?
- scgi response should be done non-chunked if it sets its content-length, to allow client (and server?) to detect if it closes prematurely.
- implement Transfer-Encoding: chunked sent by clients?  or at least send an error
- send error on incoming unsupported Content-Encoding.
- make error messages more useful, most current http daemons just say "bad request" without any other info.
- http/1.0 specifics
	* date-header allows three formats
	* charset names, "UNICODE-1-1-UTF-8" for utf-8?
	* some http/1.0 might not understand content-type parameters such as "charset=..."?
	* missing length for clients sending a body must result in 400, not 411? (rfcrfc1945#7.2.2)
	* if-modified-since should be ignored for head request (rfc1945#8.1)

- headers may only occur more than once if it is specified as a list, i.e. when joining them with a comma does not change semantics.  what about http/1.1?

- security issues with http?
- check spec which error responses must be with/without body
- read spec and determine where we need to add quoting or allow for whitespace between tokens
- ndb file for config?  can be used to select host, port, path.  perhaps even header
- make faster, prespawn procs?  do less pctl stuff to not need a spawn?!
- transparent compression?
- connection rate limiting?
- redirects based on path rewriting?
- think of ssl?
- try to fix dir listings for paths with multiple slashes in them.  firefox breaks on them, is firefox right?
- test with other browsers
- try to break it
- test cases?  automatic testing can probably be done.

- write a doc about http protocol
	* perhaps with an overview of headers that must be implemented for a minimal webserver
	* which headers are safe to ignore
	* which parts of the spec aren't used much
	* which parts of the spec are abused/misused
	* which "extensions" are encountered in the wild
	* where the spec isn't complete or contradicts itself
	* which headers are for clients/proxies/servers only.
	* which response codes return an entity body
	* common client requests
	* common server responses

install

to install this software, make sure there is a mkconfig file in
this directory.  you can symlink/bind the one from your inferno
installation.  next, type "mk install".  httpd depends on package
"http", the http library, published using mercurial:  hg clone
static-http://www.ueber.net/who/mjl/hg/http/.

latest version

this code is kept up to date using mercurial, to get a fresh copy:

	hg clone static-http://www.ueber.net/who/mjl/hg/httpd/

licence

all files written by me (i.e. all except the rfcs in doc/) are
in the public domain.  for bugs, questions, comments, etc., contact
me at mechiel@ueber.net or mechiel@xs4all.nl.
